Demo-code associated with our paper *Scaling on-chip photonic neural processors using arbitrarily programmable wave propagation*.
<p align="center">
<img src="https://github.com/user-attachments/assets/5a1bd570-0beb-4959-837f-6a1d0b965d23" width="800">
</p>

# How to get started

<details> <summary><b>Simplest simulation</b> of a refractive-index pattern</summary>

[Notebook 1](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%201--Simulating%20a%20simple%20Y-splitter.ipynb) provides code that manually defines the refractive-index distribution of a Y-splitter and simulates beam propagation through it.

</details> <details> <summary><b>Inverse design</b> of a refractive-index pattern</summary>

[Notebook 2](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%202--Minimal%20example%20of%20inverse-design.ipynb) contains a minimal inverse-design example that automatically generates a refractive-index distribution for converting Gaussian beams into Hermite–Gauss modes.

</details> <details> <summary><b>Machine learning demo</b> with MNIST</summary>

[Notebook 3](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%203--MNIST%20classification.ipynb) demonstrates MNIST image classification using a 2D-programmable waveguide.

</details> <details> <summary><b>High-dimensional MVMs</b> in multimode waveguides</summary>

[Notebook 4](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%204--Mode%20conversion%20in%20a%20Multimode%20waveguide.ipynb) introduces a step-index multimode waveguide as the background refractive index and demonstrates mode conversion using a manually defined refractive-index distribution.
[Notebook 5](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%205--Matrix-vector-multiplication.ipynb) shows how to compute a refractive-index distribution that, when embedded in a multimode waveguide, performs a desired 100×100-dimensional unitary transformation.

</details> <details> <summary><b>Physics-aware training</b> with mismatched forward/backward passes</summary>

[Notebook 6](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/Notebook%206--Minimal%20example%20of%20mismatched%20forward-backward%20pass.ipynb) presents a minimal inverse-design example using a mismatched forward and backward pass, similar to the approach used in our optical experiments with the 2D-programmable waveguide.

</details>


# How to cite this code

If you use this code in your research, please consider citing the following paper:

> Onodera, T., Stein, M. M., et al (2024). Scaling on-chip photonic neural processors using arbitrarily programmable wave propagation. *arXiv:2402.17750* https://arxiv.org/abs/2402.17750v1.

# License

This repository is licensed under:

[Creative Commons Attribution 4.0 International](https://creativecommons.org/licenses/by/4.0/)

A copy of the license is included in this repository as [license.txt](https://github.com/ms3452/2D-waveguide-demo-code/blob/main/license.txt).
